/*
 * jQuery beforeafter plugin
 * @author admin@catchmyfame.com - http://www.catchmyfame.com
 * @version 1.4
 * @date September 19, 2011
 * @category jQuery plugin
 * @copyright (c) 2009 admin@catchmyfame.com (www.catchmyfame.com)
 * @license CC Attribution-NonCommercial-ShareAlike 3.0 Unported (CC BY-NC-SA 3.0) - http://creativecommons.org/licenses/by-nc-sa/3.0/
 */(function(e){e.fn.extend({beforeAfter:function(t){var n={animateIntro:!1,introDelay:1e3,introDuration:1e3,introPosition:.5,showFullLinks:!0,beforeLinkText:"Show only before",afterLinkText:"Show only after",imagePath:"./js/",cursor:"pointer",clickSpeed:600,linkDisplaySpeed:200,dividerColor:"#888",enableKeyboard:!1,keypressAmount:20,onReady:function(){}},t=e.extend(n,t),r=Math.round(Math.random()*1e8);return this.each(function(){function f(){e("#lt-arrow"+r+", #rt-arrow"+r).stop().css("opacity",0);e("div:eq(2)",i).width(parseInt(e(this).css("left"))+4)}function l(){e(i).hover(function(){e("#lt-arrow"+r).stop().css({"z-index":"20",position:"absolute",top:o/2-e("#lt-arrow"+r).height()/2+"px",left:parseInt(e("#dragwrapper"+r).css("left"))-10+"px"}).animate({opacity:1,left:parseInt(e("#lt-arrow"+r).css("left"))-6+"px"},200);e("#rt-arrow"+r).stop().css({position:"absolute",top:o/2-e("#lt-arrow"+r).height()/2+"px",left:parseInt(e("#dragwrapper"+r).css("left"))+10+"px"}).animate({opacity:1,left:parseInt(e("#rt-arrow"+r).css("left"))+6+"px"},200);e("#dragwrapper"+r).animate({opacity:1},200)},function(){e("#lt-arrow"+r).animate({opacity:0,left:parseInt(e("#lt-arrow"+r).css("left"))-6+"px"},350);e("#rt-arrow"+r).animate({opacity:0,left:parseInt(e("#rt-arrow"+r).css("left"))+6+"px"},350);e("#dragwrapper"+r).animate({opacity:.25},350)});e(i).click(function(t){var s=t.pageX-e(this).offset().left;e("#dragwrapper"+r).stop().animate({left:s-e("#dragwrapper"+r).width()/2+"px"},n.clickSpeed);e("div:eq(2)",i).stop().animate({width:s+"px"},n.clickSpeed);e("#lt-arrow"+r+",#rt-arrow"+r).stop().animate({opacity:0},50)});e(i).one("mousemove",function(){e("#dragwrapper"+r).stop().animate({opacity:1},500)})}var n=t,i=e(this),s=e("#device-view-after",i).width(),o=e("#device-view-after",i).height();console.log("ba w/h",s,o);e("div",i).length!=2&&e("img",i).wrap("<div>");e(i).width(s).height(o).css({overflow:"hidden",position:"relative",padding:"0"});var u=e("img:first",i).attr("src"),a=e("img:last",i).attr("src");e("img:first",i).attr("id","beforeimage"+r);e("img:last",i).attr("id","afterimage"+r);e(i).prepend('<div id="dragwrapper'+r+'"><div id="drag'+r+'"><img width="8" height="56" alt="handle" src="'+n.imagePath+'handle.gif" id="handle'+r+'" /></div></div>');e("#dragwrapper"+r).css({opacity:.25,position:"absolute",padding:"0",left:s*n.introPosition-e("#handle"+r).width()/2+"px","z-index":"20"}).width(e("#handle"+r).width()).height(o);e("div:eq(2)",i).height(o).width(s*n.introPosition).css({position:"absolute",overflow:"hidden",left:"0px","z-index":"10"});e("div:eq(3)",i).height(o).width(s).css({position:"absolute",overflow:"hidden",right:"0px"});e("#drag"+r).width(2).height(o).css({background:n.dividerColor,position:"absolute",left:"3px"});e("#beforeimage"+r).css({position:"absolute",top:"0px",left:"0px"});e("#afterimage"+r).css({position:"absolute",top:"0px",right:"0px"});e("#handle"+r).css({"z-index":"100",position:"relative",cursor:n.cursor,top:o/2-e("#handle"+r).height()/2+"px",left:"-3px"});e(i).append('<img src="'+n.imagePath+'lt-small.png" width="7" height="15" id="lt-arrow'+r+'"><img src="'+n.imagePath+'rt-small.png" width="7" height="15" id="rt-arrow'+r+'">');if(n.showFullLinks){e(i).after('<div class="balinks" id="links'+r+'" style="position:relative"><span class="balinks"><a id="showleft'+r+'" href="javascript:void(0)">'+n.beforeLinkText+'</a></span><span class="balinks"><a id="showright'+r+'" href="javascript:void(0)">'+n.afterLinkText+"</a></span></div>");e("#links"+r).width(s);e("#showleft"+r).css({position:"relative",left:"0px"}).click(function(){e("div:eq(2)",i).animate({width:s},n.linkDisplaySpeed);e("#dragwrapper"+r).animate({left:s-e("#dragwrapper"+r).width()+"px"},n.linkDisplaySpeed)});e("#showright"+r).css({position:"absolute",right:"0px"}).click(function(){e("div:eq(2)",i).animate({width:0},n.linkDisplaySpeed);e("#dragwrapper"+r).animate({left:"0px"},n.linkDisplaySpeed)})}n.enableKeyboard&&e(document).keydown(function(t){if(t.keyCode==39)if(parseInt(e("#dragwrapper"+r).css("left"))+parseInt(e("#dragwrapper"+r).width())+n.keypressAmount<=s){e("#dragwrapper"+r).css("left",parseInt(e("#dragwrapper"+r).css("left"))+n.keypressAmount+"px");e("div:eq(2)",i).width(parseInt(e("div:eq(2)",i).width())+n.keypressAmount+"px")}else{e("#dragwrapper"+r).css("left",s-parseInt(e("#dragwrapper"+r).width())+"px");e("div:eq(2)",i).width(s-parseInt(e("#dragwrapper"+r).width())/2+"px")}if(t.keyCode==37)if(parseInt(e("#dragwrapper"+r).css("left"))-n.keypressAmount>=0){e("#dragwrapper"+r).css("left",parseInt(e("#dragwrapper"+r).css("left"))-n.keypressAmount+"px");e("div:eq(2)",i).width(parseInt(e("div:eq(2)",i).width())-n.keypressAmount+"px")}else{e("#dragwrapper"+r).css("left","0px");e("div:eq(2)",i).width(e("#dragwrapper"+r).width()/2)}});e("#dragwrapper"+r).draggable({containment:i,drag:f,stop:f});if(n.animateIntro){e("div:eq(2)",i).width(s);e("#dragwrapper"+r).css("left",s-e("#dragwrapper"+r).width()/2+"px");setTimeout(function(){e("#dragwrapper"+r).css({opacity:1}).animate({left:s*n.introPosition-e("#dragwrapper"+r).width()/2+"px"},n.introDuration,function(){e("#dragwrapper"+r).animate({opacity:.25},1e3)});e("div:eq(2)",i).width(s).animate({width:s*n.introPosition+"px"},n.introDuration,function(){l();n.onReady.call(this)})},n.introDelay)}else{l();n.onReady.call(this)}})}})})(jQuery);